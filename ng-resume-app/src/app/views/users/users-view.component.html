<section>

    <table id="userTable" mat-table [dataSource]="userList" class="mat-elevation-z8" multiTemplateDataRows>

        <ng-container matColumnDef="id">
          <th mat-header-cell *matHeaderCellDef> Id </th>
          <td mat-cell *matCellDef="let user"> {{user.id}} </td>
        </ng-container>
      
        <ng-container matColumnDef="displayName">
          <th mat-header-cell *matHeaderCellDef> Display Name </th>
          <td mat-cell *matCellDef="let user"> {{user.displayName}} </td>
        </ng-container>

        <ng-container matColumnDef="givenName">
          <th mat-header-cell *matHeaderCellDef> Given Name </th>
          <td mat-cell *matCellDef="let user"> {{user.givenName}} </td>
        </ng-container>

        <ng-container matColumnDef="surname">
          <th mat-header-cell *matHeaderCellDef> Surname </th>
          <td mat-cell *matCellDef="let user"> {{user.surname}} </td>
        </ng-container>

        <ng-container matColumnDef="federatedIssuer">
          <th mat-header-cell *matHeaderCellDef> Issuer </th>
          <td mat-cell *matCellDef="let user"> {{user.federatedIssuer}} </td>
        </ng-container>
           
        <ng-container matColumnDef="expand">
          <th mat-header-cell *matHeaderCellDef aria-label="row actions">&nbsp;</th>
          <td mat-cell *matCellDef="let user">

            <button 
              mat-icon-button 
              aria-label="expand row" 
              (click)="(expandedUser = expandedUser === user ? null : user); $event.stopPropagation()"
              >
              <mat-icon *ngIf="expandedUser !== user">keyboard_arrow_down</mat-icon>
              <mat-icon *ngIf="expandedUser === user">keyboard_arrow_up</mat-icon>
            </button>

          </td>
        </ng-container>

        <ng-container matColumnDef="expandedDetail">
          <td mat-cell *matCellDef="let user" [attr.colspan]="columnsToDisplayWithExpand.length">
            <div class="user-detail"
                 [@detailExpand]="user === expandedUser ? 'expanded' : 'collapsed'">

              <div>
                {{user.displayName}}
              </div>

            </div>
          </td>
        </ng-container>
      
        <tr mat-header-row *matHeaderRowDef="columnsToDisplayWithExpand"></tr>
        <tr mat-row *matRowDef="let user; columns: columnsToDisplayWithExpand;"
            class="user-row"
            [class.expanded-row]="expandedUser === user"
            (click)="expandedUser = expandedUser === user ? null : user">
        </tr>
        <tr mat-row *matRowDef="let row; columns: ['expandedDetail']" class="detail-row"></tr>
      </table>

</section>
